<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https: data:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https:; script-src 'self' 'unsafe-inline';">
    <title>Find Your Account</title>
    <link rel="stylesheet" href="forgot-password.css">
</head>
<body>
    <div class="fp-page">
        <!-- Back Arrow -->
        <div class="fp-back">
            <a href="instagram-login.html" class="fp-back-link">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"/>
                </svg>
            </a>
        </div>

        <!-- Main Content -->
        <main class="fp-main">
            <h1 class="fp-title">Find Your Account</h1>
            <p class="fp-desc">Enter your mobile number, username or email address. <a href="#" class="fp-help-link">Can't reset your password?</a></p>

            <form class="fp-form" id="fpForm" novalidate>
                <div class="fp-input-group">
                    <div class="fp-input-wrapper">
                        <input type="text" class="fp-input" id="fpInput" placeholder=" " autocomplete="username" maxlength="75" aria-label="Mobile number, username or email address">
                        <label class="fp-input-label" for="fpInput">Mobile number, username or email address</label>
                    </div>
                    <span class="fp-error" id="fpError"></span>
                </div>
                <p class="fp-notice">You may receive WhatsApp and SMS notifications from us for security and login purposes.</p>
                <button type="submit" class="fp-continue-btn" id="fpContinueBtn">Continue</button>
            </form>
        </main>

        <!-- Footer -->
        <footer class="fp-footer">
            <nav class="fp-footer-links">
                <a href="#">Meta</a>
                <a href="#">About</a>
                <a href="#">Blog</a>
                <a href="#">Jobs</a>
                <a href="#">Help</a>
                <a href="#">API</a>
                <a href="#">Privacy</a>
                <a href="#">Terms</a>
                <a href="#">Locations</a>
                <a href="#">Instagram Lite</a>
                <a href="#">Contact uploading and non-users</a>
                <a href="#">Meta Verified</a>
            </nav>
            <div class="fp-footer-bottom">
                <span class="fp-footer-lang">English (UK)
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                </span>
                <span class="fp-footer-copyright">&copy; 2026 Instagram from Meta</span>
            </div>
        </footer>
    </div>

    <script>
        // load saved theme
        let raw = localStorage.getItem('threads_theme');
        let savedTheme = 'auto';
        if (raw) {
            savedTheme = JSON.parse(raw);
        }
        if (savedTheme == 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
        } else if (savedTheme == 'light') {
            document.documentElement.removeAttribute('data-theme');
        } else {
            if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        }
    </script>
    <script>
            let input = document.getElementById('fpInput');
            let btn = document.getElementById('fpContinueBtn');
            let form = document.getElementById('fpForm');
            let errorEl = document.getElementById('fpError');
            let attempts = 0;
            let lockoutUntil = 0;

            // clean input
            function sanitize(str) {
                let div = document.createElement('div');
                div.textContent = str;
                return div.innerHTML.trim();
            }

            // check if input is valid
            function validate(val) {
                if (val == null || val == '' || val.length < 1) {
                    return 'Please enter a username, email or phone number.';
                }
                if (val.length > 74) {
                    return 'Input is too long.';
                }
                // email check
                if (val.indexOf('@') != -1) {
                    let emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailPattern.test(val)) {
                        return 'Please enter a valid email address.';
                    }
                }
                // phone check
                if (/^\+?\d+$/.test(val.replace(/[\s\-()]/g, ''))) {
                    if (val.replace(/\D/g, '').length < 6) {
                        return 'Please enter a valid phone number.';
                    }
                }
                return '';
            }

            function showError(msg) {
                errorEl.textContent = msg;
            }

            function clearError() {
                errorEl.textContent = '';
            }

            function updateBtn() {
                btn.disabled = input.value.trim().length < 1;
            }

            input.addEventListener('input', function() {
                clearError();
                updateBtn();
            });

            input.addEventListener('blur', function() {
                let val = input.value.trim();
                if (val) {
                    let err = validate(val);
                    if (err) showError(err);
                }
            });

            // enter key submits
            input.addEventListener('keydown', function(e) {
                if (e.key == 'Enter') {
                    e.preventDefault();
                    // trigger the form submit event
                    form.dispatchEvent(new Event('submit'));
                }
            });

            form.addEventListener('submit', function(e) {
                e.preventDefault();

                // rate limit
                let now = Date.now();
                if (now < lockoutUntil) {
                    let secs = Math.ceil((lockoutUntil - now) / 1000);
                    showError('Too many attempts. Try again in ' + secs + 's.');
                    return;
                }

                let val = sanitize(input.value.trim());
                if (val == null || val == '') {
                    return;
                }

                let err = validate(val);
                if (err) {
                    showError(err);
                    return;
                }

                // track attempts
                attempts++;
                if (attempts >= 5) {
                    lockoutUntil = now + 60000;
                    attempts = 0;
                    showError('Too many attempts. Try again in 60s.');
                    return;
                }

                // show loading
                btn.textContent = 'Sending...';
                btn.disabled = true;
                input.disabled = true;
                clearError();

                setTimeout(function() {
                    btn.textContent = 'Continue';
                    input.disabled = false;
                    updateBtn();

                    // show success
                    showError('');
                    let successMsg = document.createElement('div');
                    successMsg.className = 'fp-success';
                    successMsg.textContent = 'If an account exists with that information, you will receive a reset link.';
                    let existing = document.querySelector('.fp-success');
                    if (existing) existing.remove();
                    form.appendChild(successMsg);
                }, 1500);
            });
    </script>
</body>
</html>
